# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–±–æ—Ç–µ —Å AI Agent Platform API Gateway

## üìñ –í–≤–µ–¥–µ–Ω–∏–µ

–î–∞–Ω–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã —Å AI Agent Platform API Gateway. API Gateway —Å–ª—É–∂–∏—Ç –µ–¥–∏–Ω–æ–π —Ç–æ—á–∫–æ–π –≤—Ö–æ–¥–∞ –¥–ª—è –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã.

**Base URL:** `https://betaback-production.up.railway.app`

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

### –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

API Gateway –∏—Å–ø–æ–ª—å–∑—É–µ—Ç JWT (JSON Web Token) –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é —á–µ—Ä–µ–∑ Supabase. –í—Å–µ –∑–∞—â–∏—â–µ–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ç—Ä–µ–±—É—é—Ç –≤–∞–ª–∏–¥–Ω—ã–π JWT —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ –∑–∞–ø—Ä–æ—Å–∞.

### –ü–æ–ª—É—á–µ–Ω–∏–µ JWT —Ç–æ–∫–µ–Ω–∞

JWT —Ç–æ–∫–µ–Ω –ø–æ–ª—É—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ Supabase Auth –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ:

1. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è/–í—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** —á–µ—Ä–µ–∑ Supabase Auth
2. **–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞** –∏–∑ Supabase Auth session
3. **–ü–µ—Ä–µ–¥–∞—á–∞ —Ç–æ–∫–µ–Ω–∞** –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ `Authorization: Bearer <token>`

### –§–æ—Ä–º–∞—Ç —Ç–æ–∫–µ–Ω–∞

JWT —Ç–æ–∫–µ–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–µ–¥—É—é—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:
- `sub` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `email` - email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `role` - —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–æ–±—ã—á–Ω–æ "authenticated")
- `aud` - –∞—É–¥–∏—Ç–æ—Ä–∏—è —Ç–æ–∫–µ–Ω–∞ ("authenticated")
- `iss` - –∏–∑–¥–∞—Ç–µ–ª—å —Ç–æ–∫–µ–Ω–∞ (Supabase URL)
- `exp` - –≤—Ä–µ–º—è –∏—Å—Ç–µ—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞
- `iat` - –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–æ–∫–µ–Ω–∞

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞

–í—Å–µ –∑–∞—â–∏—â–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –¥–æ–ª–∂–Ω—ã —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫:
```
Authorization: Bearer <your-jwt-token>
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

- **401 Unauthorized** - —Ç–æ–∫–µ–Ω –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω
- **403 Forbidden** - —Ç–æ–∫–µ–Ω –≤–∞–ª–∏–¥–µ–Ω, –Ω–æ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤
- **422 Unprocessable Entity** - —Ç–æ–∫–µ–Ω –∏–º–µ–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç

## üåê CORS (Cross-Origin Resource Sharing)

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CORS

API Gateway –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

- **–†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã:** –ù–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `ALLOWED_ORIGINS`
- **–†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã:** GET, POST, PUT, DELETE, OPTIONS, PATCH
- **–†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏:** Authorization, Content-Type, Origin, –∏ –¥—Ä—É–≥–∏–µ
- **Credentials:** –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è (cookies, authorization headers)

### Preflight –∑–∞–ø—Ä–æ—Å—ã

–ë—Ä–∞—É–∑–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç OPTIONS –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ CORS. API Gateway –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —ç—Ç–∏ –∑–∞–ø—Ä–æ—Å—ã –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏.

#### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º —Å CORS

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—ã —Å CORS, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ CORS:**
   ```bash
   GET /cors-debug
   ```
   –≠—Ç–æ—Ç —ç–Ω–¥–ø–æ–∏–Ω—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é CORS.

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ preflight –∑–∞–ø—Ä–æ—Å–æ–≤:**
   ```bash
   OPTIONS /api/v1/me
   ```
   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ `Access-Control-Allow-Origin`.

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:**
   - –õ–æ–≥–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–∞—Ä—Å–∏–Ω–≥–µ CORS –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
   - –ò—â–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å "CORS parsing" –∏ "CORS request"

#### –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

- **–û—à–∏–±–∫–∞ "No 'Access-Control-Allow-Origin' header":**
  - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `ALLOWED_ORIGINS`
  - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–æ–º–µ–Ω —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –≤–∫–ª—é—á–µ–Ω –≤ —Å–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö
  - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –æ—à–∏–±–æ–∫ –ø–∞—Ä—Å–∏–Ω–≥–∞

- **CORS —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ development, –Ω–æ –Ω–µ –≤ production:**
  - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Railway
  - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è HTTPS –¥–ª—è production –¥–æ–º–µ–Ω–æ–≤

## üì° –û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

#### Health Check
**GET** `/health`

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã.

**–û—Ç–≤–µ—Ç:**
- `status` - –æ–±—â–∏–π —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã (success/degraded/error)
- `message` - –æ–ø–∏—Å–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- `services` - –º–∞—Å—Å–∏–≤ —Å—Ç–∞—Ç—É—Å–æ–≤ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- `overall_status` - –æ–±—â–∏–π —Å—Ç–∞—Ç—É—Å (healthy/degraded/unhealthy)
- `version` - –≤–µ—Ä—Å–∏—è API Gateway
- `timestamp` - –≤—Ä–µ–º—è –ø—Ä–æ–≤–µ—Ä–∫–∏

#### Ping
**GET** `/ping`

–ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API Gateway.

**–û—Ç–≤–µ—Ç:**
- `status` - "ok"
- `timestamp` - —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è –≤ ISO —Ñ–æ—Ä–º–∞—Ç–µ

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

#### –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
**GET** `/api/v1/me`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–∫—É—â–µ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ.

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- JWT —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ Authorization

**–û—Ç–≤–µ—Ç:**
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –∏–∑ AMS —Å–µ—Ä–≤–∏—Å–∞
- –°–ø–∏—Å–æ–∫ –∞–≥–µ–Ω—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è

### AMS (Agent Management Service) - –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –∞–≥–µ–Ω—Ç–∞–º–∏ –∏ —à–∞–±–ª–æ–Ω–∞–º–∏ —Ç–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ –µ–¥–∏–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç `/api/v1/ams/`.

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è AMS
**GET** `/api/v1/ams/health`

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å AMS —Å–µ—Ä–≤–∏—Å–∞.

#### –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
**GET** `/api/v1/ams/me`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –∏ –µ–≥–æ –∞–≥–µ–Ω—Ç–∞—Ö.

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- JWT —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ Authorization

**–û—Ç–≤–µ—Ç:**
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
- –°–ø–∏—Å–æ–∫ –∞–≥–µ–Ω—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è

#### –°–æ–∑–¥–∞–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞
**POST** `/api/v1/ams/agents/create`

–°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤–æ–≥–æ –∞–≥–µ–Ω—Ç–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- JWT —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ Authorization
- –î–∞–Ω–Ω—ã–µ –∞–≥–µ–Ω—Ç–∞ –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "template_id": "test-bot",
  "agent_name": "My Test Agent",
  "use_latest": true,
  "variables": {
    "custom_var": "value"
  }
}
```

#### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞
**POST** `/api/v1/ams/agents/{agent_id}/upgrade`

–û–±–Ω–æ–≤–ª—è–µ—Ç –∞–≥–µ–Ω—Ç–∞ –¥–æ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏.

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- JWT —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ Authorization
- ID –∞–≥–µ–Ω—Ç–∞ –≤ URL

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "target_version": "2.0.0",
  "use_latest": false,
  "dry_run": true,
  "use_queue": false
}
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞–º–∏

#### –í–∞–ª–∏–¥–∞—Ü–∏—è —à–∞–±–ª–æ–Ω–∞
**POST** `/api/v1/ams/templates/validate`

–í–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —à–∞–±–ª–æ–Ω–∞.

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- JWT —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ Authorization
- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —à–∞–±–ª–æ–Ω–∞ –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "template_content": "af_version: 1\ntemplate:\n  id: test-bot\n  name: Test Bot\n  version: 1.0.0\n...",
  "template_format": "yaml",
  "strict_validation": true
}
```

#### –ü—É–±–ª–∏–∫–∞—Ü–∏—è —à–∞–±–ª–æ–Ω–∞
**POST** `/api/v1/ams/templates/publish`

–ü—É–±–ª–∏–∫—É–µ—Ç –Ω–æ–≤—ã–π —à–∞–±–ª–æ–Ω –∏–ª–∏ –≤–µ—Ä—Å–∏—é —à–∞–±–ª–æ–Ω–∞.

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- JWT —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ Authorization
- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —à–∞–±–ª–æ–Ω–∞ –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "template_id": "test-bot",
  "version": "1.0.0",
  "is_public": true,
  "changelog": "Initial release",
  "tags": ["support", "customer-service"]
}
```

### –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø—Ä–æ–∫—Å–∏

–î–ª—è –ª—é–±—ã—Ö –¥—Ä—É–≥–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å AMS –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç:

**ANY** `/api/v1/ams/{path}`

–ì–¥–µ `{path}` - –ª—é–±–æ–π –ø—É—Ç—å –∫ AMS —ç–Ω–¥–ø–æ–∏–Ω—Ç—É. –ù–∞–ø—Ä–∏–º–µ—Ä:
- `/api/v1/ams/agents/list` - —Å–ø–∏—Å–æ–∫ –∞–≥–µ–Ω—Ç–æ–≤
- `/api/v1/ams/templates/list` - —Å–ø–∏—Å–æ–∫ —à–∞–±–ª–æ–Ω–æ–≤
- `/api/v1/ams/agents/{agent_id}` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–≥–µ–Ω—Ç–µ

#### –£–¥–∞–ª–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞
**DELETE** `/api/v1/agents/{agent_id}`

–£–¥–∞–ª—è–µ—Ç –∞–≥–µ–Ω—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- JWT —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ Authorization
- ID –∞–≥–µ–Ω—Ç–∞ –≤ URL

### –®–∞–±–ª–æ–Ω—ã –∞–≥–µ–Ω—Ç–æ–≤

#### –í–∞–ª–∏–¥–∞—Ü–∏—è —à–∞–±–ª–æ–Ω–∞
**POST** `/api/v1/templates/validate`

–í–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —à–∞–±–ª–æ–Ω–∞ –∞–≥–µ–Ω—Ç–∞.

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- JWT —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ Authorization
- –î–∞–Ω–Ω—ã–µ —à–∞–±–ª–æ–Ω–∞ –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
- `content` - —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —à–∞–±–ª–æ–Ω–∞ (YAML –∏–ª–∏ JSON)
- `format` - —Ñ–æ—Ä–º–∞—Ç —à–∞–±–ª–æ–Ω–∞ ("yaml" –∏–ª–∏ "json")

**–û—Ç–≤–µ—Ç:**
- `valid` - –±—É–ª–µ–≤–æ –∑–Ω–∞—á–µ–Ω–∏–µ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏
- `errors` - –º–∞—Å—Å–∏–≤ –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)
- `warnings` - –º–∞—Å—Å–∏–≤ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π (–µ—Å–ª–∏ –µ—Å—Ç—å)

#### –ü—É–±–ª–∏–∫–∞—Ü–∏—è —à–∞–±–ª–æ–Ω–∞
**POST** `/api/v1/templates/publish`

–ü—É–±–ª–∏–∫—É–µ—Ç —à–∞–±–ª–æ–Ω –∞–≥–µ–Ω—Ç–∞.

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- JWT —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ Authorization
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –ø—Ä–∞–≤–∞
- –î–∞–Ω–Ω—ã–µ —à–∞–±–ª–æ–Ω–∞ –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞

### Letta –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

#### –ü—Ä–æ–∫—Å–∏ –∫ Letta API
**POST** `/api/v1/letta/{path:path}`

–ü—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∫ Letta —Å–µ—Ä–≤–∏—Å—É.

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- JWT —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ Authorization
- –ü—É—Ç—å –∫ Letta —ç–Ω–¥–ø–æ–∏–Ω—Ç—É –≤ URL

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞
- –í–æ–∑–≤—Ä–∞—Ç –æ—Ç–≤–µ—Ç–∞ –æ—Ç Letta —Å–µ—Ä–≤–∏—Å–∞

### LLM Proxy

#### –ü—Ä–æ–∫—Å–∏ –∫ LiteLLM
**POST** `/api/v1/agents/{agent_id}/proxy`

–ü—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∫ LLM —á–µ—Ä–µ–∑ LiteLLM —Å–µ—Ä–≤–∏—Å.

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- JWT —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ Authorization
- ID –∞–≥–µ–Ω—Ç–∞ –≤ URL
- –î–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å–∞ –≤ —Ç–µ–ª–µ

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Agent Secret Key
- –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º—É LLM
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ —Ç–∞–π–º–∞—É—Ç–æ–≤
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ Server-Sent Events (SSE)
- **–°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –ø–æ–ª–µ–π –æ—Ç Gemini

#### –°—Ç—Ä–∏–º–∏–Ω–≥ –∑–∞–ø—Ä–æ—Å—ã

–î–ª—è —Å—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `stream: true` –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞:

```json
{
  "model": "gpt-4",
  "messages": [{"role": "user", "content": "Hello"}],
  "stream": true
}
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞:**
- –û—Ç–≤–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∫–∞–∫ `text/event-stream`
- –î–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ Server-Sent Events (SSE)
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ä–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –ø–µ—Ä–µ–¥–∞—á–∏ –±–µ–∑ –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏–∏
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

#### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

**Gemini —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ `usage.prompt_tokens_details.cached_tokens = null`
- –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –ø–æ–ª–µ–π usage –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- –û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –≤—Å–µ—Ö —Ç–æ–∫–µ–Ω–æ–≤

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏

### Prometheus –º–µ—Ç—Ä–∏–∫–∏
**GET** `/metrics`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Prometheus –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.

**–î–æ—Å—Ç—É–ø–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:**
- `http_requests_total` - –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤
- `http_request_duration_seconds` - –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- `auth_attempts_total` - –ø–æ–ø—ã—Ç–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- `circuit_breaker_state` - —Å–æ—Å—Ç–æ—è–Ω–∏–µ circuit breaker

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

API Gateway –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ. –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è —Å:
- –£–Ω–∏–∫–∞–ª—å–Ω—ã–º request_id
- –í—Ä–µ–º–µ–Ω–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –°—Ç–∞—Ç—É—Å –∫–æ–¥–æ–º –æ—Ç–≤–µ—Ç–∞
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ (–µ—Å–ª–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω)

## ‚ö° Rate Limiting

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏

API Gateway –ø—Ä–∏–º–µ–Ω—è–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π:

- **–û–±—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã:** 1000 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —á–∞—Å –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **LLM –∑–∞–ø—Ä–æ—Å—ã:** 100 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —á–∞—Å –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **Proxy –∑–∞–ø—Ä–æ—Å—ã:** 500 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —á–∞—Å –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ó–∞–≥–æ–ª–æ–≤–∫–∏ Rate Limiting

–û—Ç–≤–µ—Ç—ã —Å–æ–¥–µ—Ä–∂–∞—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è—Ö:
- `X-RateLimit-Limit` - –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤
- `X-RateLimit-Remaining` - –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –∑–∞–ø—Ä–æ—Å—ã
- `X-RateLimit-Reset` - –≤—Ä–µ–º—è —Å–±—Ä–æ—Å–∞ –ª–∏–º–∏—Ç–∞

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è –ª–∏–º–∏—Ç–∞

–ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è:
- **429 Too Many Requests**
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—Ä–µ–º–µ–Ω–∏ —Å–±—Ä–æ—Å–∞ –ª–∏–º–∏—Ç–∞
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤

## üîÑ Circuit Breaker

### –û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å

API Gateway –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Circuit Breaker –ø–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏.

### –°–æ—Å—Ç–æ—è–Ω–∏—è Circuit Breaker

- **CLOSED** - –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞, –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- **OPEN** - —Å–µ—Ä–≤–∏—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∑–∞–ø—Ä–æ—Å—ã –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
- **HALF_OPEN** - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏

- **Failure Threshold:** 5 –Ω–µ—É–¥–∞—á–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ–¥—Ä—è–¥
- **Recovery Timeout:** 60 —Å–µ–∫—É–Ω–¥
- **Expected Exceptions:** –≤—Å–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è —Å—á–∏—Ç–∞—é—Ç—Å—è –Ω–µ—É–¥–∞—á–Ω—ã–º–∏

## üóÑÔ∏è –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

### Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

API Gateway –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö:

- **JWT –≤–∞–ª–∏–¥–∞—Ü–∏—è:** 5 –º–∏–Ω—É—Ç
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–æ—Ñ–∏–ª–∏:** 5 –º–∏–Ω—É—Ç
- **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:** 10 –º–∏–Ω—É—Ç
- **Health checks:** 1 –º–∏–Ω—É—Ç–∞

### –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

- **Write-through** - –¥–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –∫—ç—à –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
- **TTL-based** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å—Ç–µ—á–µ–Ω–∏–µ –∫—ç—à–∞
- **Invalidation** - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞

## üö® –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—à–∏–±–æ–∫

–í—Å–µ –æ—à–∏–±–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ –µ–¥–∏–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ:

```json
{
  "status": "error",
  "message": "–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏",
  "timestamp": "2025-09-21T14:00:00Z",
  "request_id": "unique-request-id",
  "error": {
    "code": "ERROR_CODE",
    "message": "–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ",
    "context": {
      "additional_info": "value"
    }
  }
}
```

### –ö–æ–¥—ã –æ—à–∏–±–æ–∫

- **AUTHENTICATION_ERROR** - –ø—Ä–æ–±–ª–µ–º—ã —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π
- **AUTHORIZATION_ERROR** - –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤
- **VALIDATION_ERROR** - –æ—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- **NOT_FOUND** - —Ä–µ—Å—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω
- **RATE_LIMIT_EXCEEDED** - –ø—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤
- **SERVICE_UNAVAILABLE** - –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- **INTERNAL_ERROR** - –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

### HTTP —Å—Ç–∞—Ç—É—Å –∫–æ–¥—ã

- **200 OK** - —É—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—Ä–æ—Å
- **201 Created** - —Ä–µ—Å—É—Ä—Å —Å–æ–∑–¥–∞–Ω
- **400 Bad Request** - –Ω–µ–≤–µ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å
- **401 Unauthorized** - –Ω–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω
- **403 Forbidden** - –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤
- **404 Not Found** - —Ä–µ—Å—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω
- **422 Unprocessable Entity** - –æ—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- **429 Too Many Requests** - –ø—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç
- **500 Internal Server Error** - –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞
- **503 Service Unavailable** - —Å–µ—Ä–≤–∏—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞

### –ë–∞–∑–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```javascript
const API_BASE_URL = 'https://betaback-production.up.railway.app';
const API_TIMEOUT = 30000; // 30 —Å–µ–∫—É–Ω–¥
```

### –ó–∞–≥–æ–ª–æ–≤–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

```javascript
const defaultHeaders = {
  'Content-Type': 'application/json',
  'Accept': 'application/json',
  'User-Agent': 'YourApp/1.0.0'
};
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

```javascript
// –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –∏–∑ Supabase
const { data: { session } } = await supabase.auth.getSession();
const token = session?.access_token;

// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –∫ –∑–∞–ø—Ä–æ—Å–∞–º
const authHeaders = {
  ...defaultHeaders,
  'Authorization': `Bearer ${token}`
};
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

```javascript
try {
  const response = await fetch(`${API_BASE_URL}/api/v1/me`, {
    headers: authHeaders
  });
  
  if (!response.ok) {
    const error = await response.json();
    throw new Error(error.message);
  }
  
  const data = await response.json();
  return data;
} catch (error) {
  console.error('API Error:', error);
  throw error;
}
```

## üì± –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - API Gateway –∫—ç—à–∏—Ä—É–µ—Ç —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ
2. **–ì—Ä—É–ø–ø–∏—Ä—É–π—Ç–µ –∑–∞–ø—Ä–æ—Å—ã** - –∏–∑–±–µ–≥–∞–π—Ç–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
3. **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –æ—à–∏–±–∫–∏** - –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ retry –ª–æ–≥–∏–∫—É** - –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫ —Å–µ—Ç–∏

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Ö—Ä–∞–Ω–∏—Ç–µ JWT —Ç–æ–∫–µ–Ω—ã** –≤ localStorage –±–µ–∑ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
2. **–û–±–Ω–æ–≤–ª—è–π—Ç–µ —Ç–æ–∫–µ–Ω—ã** –ø–µ—Ä–µ–¥ –∏—Å—Ç–µ—á–µ–Ω–∏–µ–º —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è
3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS** –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
4. **–í–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ** –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ pagination** –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤
2. **–†–µ–∞–ª–∏–∑—É–π—Ç–µ debouncing** –¥–ª—è –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
3. **–ö—ç—à–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ** –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ WebSocket** –¥–ª—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π (–µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)

## üîç –û—Ç–ª–∞–¥–∫–∞

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤

–í–∫–ª—é—á–∏—Ç–µ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:

```javascript
const debugRequest = async (url, options) => {
  console.log('Request:', { url, options });
  const response = await fetch(url, options);
  console.log('Response:', {
    status: response.status,
    headers: Object.fromEntries(response.headers.entries())
  });
  return response;
};
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ CORS

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞—à –¥–æ–º–µ–Ω –¥–æ–±–∞–≤–ª–µ–Ω –≤ `ALLOWED_ORIGINS`:

```bash
curl -H "Origin: https://your-domain.com" \
     -H "Access-Control-Request-Method: GET" \
     -X OPTIONS \
     https://betaback-production.up.railway.app/health
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å JWT —Ç–æ–∫–µ–Ω–∞:

```bash
curl -H "Authorization: Bearer YOUR_JWT_TOKEN" \
     https://betaback-production.up.railway.app/api/v1/me
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

### –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–º–æ—â–∏

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é** - `/docs` –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å** - `/health` –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ request_id –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
4. **–°–æ–∑–¥–∞–π—Ç–µ issue** - –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞

### –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- **API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** https://betaback-production.up.railway.app/docs
- **Health check:** https://betaback-production.up.railway.app/health
- **OpenAPI —Å—Ö–µ–º–∞:** https://betaback-production.up.railway.app/openapi.json

---

**–í–µ—Ä—Å–∏—è API:** 1.0.0  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 21 —Å–µ–Ω—Ç—è–±—Ä—è 2025
